# PYMECompress 项目结构

## 目录树

```
pymecompress/
├── pymecompress/          # 主包目录
│   ├── bcl/               # BCL压缩库源码
│   │   ├── doc/           # BCL文档
│   │   ├── huffman.c/h    # 霍夫曼编码实现
│   │   ├── lz.c/h         # LZ压缩（未使用）
│   │   ├── rice.c/h       # Rice编码（未使用）
│   │   ├── rle.c/h        # 游程编码（未使用）
│   │   └── shannonfano.c/h # Shannon-Fano编码（未使用）
│   ├── win_incl/          # Windows兼容头文件
│   ├── __init__.py        # 包初始化文件
│   ├── bcl.pyx            # Cython包装器
│   ├── bcl.c              # 编译后的C文件
│   ├── codecs.py          # numcodecs编解码器
│   ├── quantize.c         # 量化实现
│   ├── quantize.h         # 量化头文件
│   ├── quantize.dispatch.c # 多架构分发
│   ├── version.py         # 版本信息
│   ├── setup.py           # 子包构建脚本
│   └── meson.build        # Meson构建配置
├── test_data/             # 测试数据
│   └── *.mat              # MATLAB格式测试文件
├── docs/                  # 文档目录（本文档）
├── setup.py               # 主安装脚本
├── pyproject.toml         # 项目配置文件
├── meson.build            # 主Meson构建文件
├── requirements.txt       # 依赖列表
├── test_pymecompress.py   # 单元测试
├── azure-pipelines.yml    # CI/CD配置
├── MANIFEST.in            # 打包清单
├── LICENSE                # 许可证文件
├── README.md              # 项目说明
├── .gitignore             # Git忽略配置
├── libpython27.a          # Python 2.7库（Windows）
├── mingw_native.ini       # MinGW配置
└── setup.cfg.win          # Windows构建配置
```

## 核心模块结构

### 1. 核心压缩模块 (pymecompress/)

```
pymecompress/
├── bcl.pyx               # Cython接口层
├── quantize.c            # 量化算法实现
├── bcl/huffman.c         # 霍夫曼编码实现
└── codecs.py             # 高级编解码器接口
```

### 2. 构建系统

```
├── setup.py              # NumPy distutils构建
├── meson.build           # Meson构建（现代方式）
└── pyproject.toml        # PEP 518配置
```

### 3. 测试和CI

```
├── test_pymecompress.py  # pytest单元测试
└── azure-pipelines.yml   # Azure DevOps CI
```

### 4. 文档和许可

```
├── README.md             # 用户文档
├── LICENSE               # BSD-3许可证
└── docs/                 # 详细文档
```

## 代码层次结构

```
用户代码
    ↓
codecs.py (高级API)
    ↓
bcl.pyx (Cython包装)
    ↓
huffman.c + quantize.c (C实现)
    ↓
硬件 (AVX指令)
```

## 数据流

```
输入图像 (uint16)
    ↓
quantize.c (量化)
    ↓
bcl/huffman.c (霍夫曼编码)
    ↓
压缩数据 (bytes)
```

## 关键文件说明

| 文件路径 | 作用 | 语言 |
|---------|------|------|
| `pymecompress/__init__.py` | 包入口，导出主要API | Python |
| `pymecompress/bcl.pyx` | Cython包装层 | Cython |
| `pymecompress/codecs.py` | numcodecs兼容编解码器 | Python |
| `pymecompress/quantize.c` | AVX优化量化算法 | C |
| `pymecompress/bcl/huffman.c` | 霍夫曼编码核心 | C |
| `setup.py` | 构建和安装脚本 | Python |
| `test_pymecompress.py` | 单元测试 | Python |

